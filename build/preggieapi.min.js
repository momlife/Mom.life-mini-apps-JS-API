/*! PREGGIE_JSAPI | 2016-01-06 */
window.PREGGIEAPI||(window.PREGGIEAPI=function(d){var b={},a={},f={},c=[],e={},g={forced_loading:!1},h=function(a){var b=a||[],c=function(a){for(var c=0;c<b.length;c++)a(b[c],c,b);return b};return{forEach:function(a){return c(function(){a.apply(b,arguments)})},map:function(a){var k=[];c(function(){k.push(a.apply(b,arguments))});return k},filter:function(a){var k=[];c(function(){a.apply(b,arguments)&&k.push(arguments[0])});return k}}},l=function(a,b){c.push([a,b]);m()},m=function(){var a=[];c=h(c).filter(function(c){return 0<
h(c[1]).filter(function(a){return!b[a]}).length||function(){a.push(function(a,b){return function(){a(b)}}(c[0],p(c[1])))}()});h(a).forEach(function(a){a()})},p=function(a){var c={};h(a).forEach(function(a){var k=c,d=a.split("."),f=d.pop();h(d).forEach(function(a){k=k[a]||(k[a]={})});k[f]=b[a]});return c},r=function(a){return{run:function(b){l(function(a){b.call(window[d],a)},a)},module:function(c,f){l(function(a){b[c]||(b[c]=f.call(window[d],a||void 0));m()},a);e[q(c)]=c}}},n=function(a){for(var b=
document.getElementsByTagName("script"),c=0;c<b.length;c++){var d=b[c].getAttribute("src")||"";if(-1!=d.indexOf(a))return d.substr(0,d.indexOf(a))}return""},q=function(b){for(var c in f)if(0==b.indexOf(c))return f[c];return function(){for(var c=b.length+1;0<--c;){var d=b.substring(0,c);if("undefined"!=typeof a[d])return a[d]+"/"+b.substr(d.length).split(".").join("/")+".js"}return n("/preggieapi.")+"/plugins/"+b.split(".").join("/")+".js"}().replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}).replace(/\/-/g,
"/")};(function(){return function(a){if(!e[a]||g.forced_loading){var b=document.createElement("script");b.setAttribute("src",a+(g.forced_loading?"?"+Math.random():""));b.setAttribute("type","text/javascript");document.getElementsByTagName("head")[0].appendChild(b);e[a]=!0}else m()}})();var s=function(a){var b=function(a){var b=a.match(/^(.*)\((.*)\)$/)||[];return 3==b.length?h(b[2].split("|")).map(function(a){return b[1]+a}):[a]},c=[];h(a).forEach(function(a){h(b(a)).forEach(function(a){c.push(a)})});
return c};a["preggieapi."]=n("/preggieapi.")+"/plugins";return{load:function(){return r(s(arguments))},addPath:function(b,c){a[b]=c},addPackage:function(a,b){f[a]=b},publicateAPI:function(a,b){"undefined"==typeof window[d][a]&&(window[d][a]=b);return b},self:function(a){e[a]=!0},module:function(a,c){b[a]||(b[a]=c.call(window[d],void 0));m()},setup:function(a){for(var b in a)g[b]=a[b];return this},$debugger:{modules:b,paths:a,packages:f,hooks:c}}}("PREGGIEAPI"));
PREGGIEAPI.load("device","utils","random").module("api",function(d){var b=function(){};b.prototype.deviceInterface=function(){return this};b.prototype.getCurrentUserId=function(){return"12345"};b.prototype.showToast=function(a){alert(a)};b.prototype.getAuthToken=function(){return"JWT eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0NjA3MjM3NDAsIm9yaWdfaWF0IjoxNDUyMDgzNzQwLCJlbWFpbCI6ImFzZGFkQGFzZC5ydSIsInVzZXJuYW1lIjoiYWRtaW4iLCJ1c2VyX2lkIjoxfQ.g7QP_zYP_OvdBJzvyAlDTQ2ydu0WEXMx2UFE3yON9a4"};b.prototype.upload=
function(a,b){b=JSON.parse(b);var d=0,g=setInterval(function(){window[b.progress]({progress:d+=10});100==d&&(clearInterval(g),window[b.success]({name:"2015:12:23:0820a982-8837-4f26-b8e0-cea32c121c6c.jpg"}))},500);window[b.preview]("iVBORw0KGgoAAAANSUhEUgAAADEAAAA0CAIAAACsM0f4AAADPklEQVR42u2X30tTYRjHj+gMttqPznYwu9CbKUxCyh9sI6YLERkuJdRQKoKg/gDvu+jeP6Cgq0ohJLULiVkXDpRASwbbErdgY8yBUslsQzfDHjzx8uz17OxsHLcZ52EX73nPe57z2fN+n+d9Ts3x8TFTZVajMClMCpPCpDCdb6ZU6ncsFhFZYTSaWJYTvJXNZnZ3E3t7P/hLvZ41ma6oVPX5XMF6shhMo7moVl8SYNrc9E9NPRVhcrvH3O671GQ6vR8IbESjIWq+p8cFWPlcra158SMWy3WL5YY8TNvb0aWl9xqN+vRiESb4G4uLb/GMbEzJ5M+5uTeCQOJMVJCKYDIYTFqtDq9wOgfsdie5nJ9/fXR0SC61WkNLyzVQBoxBmhzXICgRUNLCwitqUirT5OSz1ta2fDGDXVtd/UguOzsdzc1mRoIFg1+DwY0zYfJ6P+zsxMU9CgZpevo5v92pVJrsuzxMs7Mv+QG4nph4IpL2+YJkNreFQgHZmKAULS8v8mOOu+pwDBQbJHhKp9PLyQS+fL7P2B3IKxz+dnCQNhiMICzBjItEQuvrXn5st/f5/V+SyV/FMdlsvUZjTtWGpOPrON4C8B6PR6nchn1pb7dSL5iZeaFS1Z4E7M/4+GOP513RTKeNRA4LHMsi9w/0NTY2CQaJT1KZmbC7fFZXd2F4+F6+IFFO5GcCwdpst7LZQ49nAVdRl2uML5u4mMGeQmhLZBLRE8Uk+G68fWQ9LhylMInkHXYHR0p//x1yi9Qt8iZcOPC7K8mEEwJEplb/q92JRJzUcRAZyxphgF0Vx4QP9oJMUhKC2MjIoxKZcH2i8qtiTFgiYEND93nZUs0a30KViYnqgUh6w4GD6ydhFTR56hPuM6leEZgymQyeaWoyd3U5RLzJz3S6p8YGdWh09KFgn3mGTEzuEUYZddiVj4k5EfvKyieqK7dae7Xay0whk8RU8ncw7CN8FDAnn5oSG06JVpXf5grT/8EUi30Ph3M62o6Om1Ky6QyZtrZ88MO3bbZ+lm2oPFNtbX13dy8/A0GSN89LZNJo9E7n7TJznEMmOEo5rpGfqQhcAY0PDj6oCias8fInHXNu9KQwCdhfKV/ntwyR1acAAAAASUVORK5CYII=");
return g};b.prototype.cancelUpload=function(a){clearInterval(a)};b.prototype.makePayment=function(a,b){b=JSON.parse(b);setTimeout(function(){window[b.success]({transaction_id:d.random.randomNumber(),additionalDate:{}})},1E3)};b.prototype.getAppId=function(){return"12345"};var a=function(){this.deviceInterface=function(){return d.device.os.android()?window.Android:d.device.os.ios()?window.iOS:(new b).deviceInterface()}};a.prototype=Object.create(b.prototype);a.prototype.constructor=a;a.prototype.getCurrentUserId=
function(){return this.deviceInterface().getCurrentUserId()};a.prototype.showToast=function(a){this.deviceInterface().showToast(a)};a.prototype.getAuthToken=function(){return this.deviceInterface().getAuthToken()};a.prototype.upload=function(a,b){var e=d.utils.createGlobalCallback(b.preview),g=d.utils.createGlobalCallback(b.progress),h=d.utils.createGlobalCallback(function(a){[e,g,h,l].forEach(function(a){d.utils.removeGlobalCallback(a)});b.success&&b.success(a)}),l=d.utils.createGlobalCallback(function(a){b.error&&
b.error(a)});return this.deviceInterface().upload(a,JSON.stringify({preview:e,progress:g,success:h,error:l}))};a.prototype.cancelUpload=function(a){this.deviceInterface().cancelUpload(a)};a.prototype.makePayment=function(a,b){var e=d.utils.createGlobalCallback(function(a){[e,g].forEach(function(a){d.utils.removeGlobalCallback(a)});b.success&&b.success(a)}),g=d.utils.createGlobalCallback(function(a){[e,a].forEach(function(a){d.utils.removeGlobalCallback(a)});b.error&&b.error(a)});this.deviceInterface().makePayment(a,
JSON.stringify({success:e,error:g}))};a.prototype.getAppId=function(){return this.deviceInterface().getAppId()};return this.publicateAPI("API",new a)});
PREGGIEAPI.module("date",function(){var d={absolute:function(){var b=new Date(0);return{day:function(a){return b.setDate(a),this},month:function(a){return b.setMonth(a-1),this},year:function(a){return b.setFullYear(a),this},getTime:function(){return b.getTime()},getUTC:function(){return b.toUTCString()}}},unixtime:function(b){return~~((b||new Date).getTime()/1E3)},toLocaleString:function(b,a,f){return(new Date(1E3*(b||d.unixtime()))).toLocaleString(a||"ru",f)},H_M:function(b){var a=new Date(1E3*b);
b=10>a.getHours()?"0"+a.getHours():a.getHours();a=10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes();return b+":"+a}};return this.publicateAPI("date",d)});
PREGGIEAPI.module("device",function(d){d=navigator.userAgent;var b=null;d.match(/Web[kK]it[\/]{0,1}([\d.]+)/);var a=d.match(/(Android);?[\s\/]+([\d.]+)?/),f=d.match(/(iPad).*OS\s([\d_]+)/),c=d.match(/(iPod)(.*OS\s([\d_]+))?/),e=!f&&d.match(/(iPhone\sOS)\s([\d_]+)/);d={platform:{name:(navigator.platform.match(/mac|win|linux/i)||["unknown"])[0].toLowerCase()},webview:function(){return"undefined"!=typeof window.Android||"undefined"!=typeof window.iOS},os:{version:function(){return b},android:function(){a&&
(b=a[2]);return a},ios:function(){return this.ipad()||this.ipod()||this.iphone()},ipad:function(){f&&(b=f[2].replace(/_/g,"."));return f},ipod:function(){c&&(b=c[3]?c[3].replace(/_/g,"."):null);return c},iphone:function(){e&&!c&&(b=e[2].replace(/_/g,"."));return e}}};return this.publicateAPI("device",d)});
PREGGIEAPI.module("random",function(){var d=function(b,a){for(var d=a||"ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz_0123456789",c=b||16,e=[],g=0,h=d.length-1;g<c;g++)e.push(d.charAt(Math.round(Math.random()*h)));return e.join("")};return this.publicateAPI("random",{randomString:d,randomId:function(b){return"_"+d(b)},randomNumber:function(b){return parseInt(Math.random().toString().substr(2,b||10))}})});
PREGGIEAPI.load("random").module("utils",function(d){var b=window;return this.publicateAPI("utils",{createGlobalCallback:function(a,f,c){f=function(c){b[c]=function(c){a.call(b,c)};return c};for(c=0;10>c++;){var e="_"+d.random.randomString();if("undefined"==typeof b[e])return f(e)}throw Error("createGlobalCallback: cannot create unique name for callback");},removeGlobalCallback:function(a){try{b[a]=void 0,delete b[a]}catch(d){}},plural:function(a,b,c){var d=[2,0,1,1,1,2];return(c?a+" ":"")+b[4<a%
100&&20>a%100?2:d[5>a%10?a%10:5]]}})});
