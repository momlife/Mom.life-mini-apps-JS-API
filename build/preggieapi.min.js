/*! momlife-extensions-js-api | 2016-10-26 */
(Modules=window.Modules||{}).name=Modules.name||"Modules",Modules&&Modules.load||(Modules=window[Modules.name]=function(a){var b={},c={},d={},e=[],f={},g={},h={forced_loading:!1},i=function(){window.console&&console.warn.apply(console,arguments)},j=function(a){var b=a||[],c=function(a){for(var c=0;c<b.length;c++)a(b[c],c,b);return b};return{forEach:function(a){return c(function(){a.apply(b,arguments)})},map:function(a){var d=[];return c(function(){d.push(a.apply(b,arguments))}),d},filter:function(a){var d=[];return c(function(){a.apply(b,arguments)&&d.push(arguments[0])}),d}}},k=function(a,b){e.push([a,b]),m()},l=function(c,d,e){b[c]||(b[c]=d.call(window[a],e||void 0)),m()},m=function(){var a=[];e=j(e).filter(function(c){return j(c[1]).filter(function(a){return!b[a]}).length>0||function(){a.push(function(a,b){return function(){a(b)}}(c[0],n(c[1])))}()}),j(a).forEach(function(a){a()})},n=function(a){var c={};return j(a).forEach(function(a){var d=c,e=a.split("."),f=e.pop();j(e).forEach(function(a){d=d[a]||(d[a]={})}),d[f]=b[a]}),c},o=function(b){return{run:function(c){k(function(b){c.call(window[a],b)},b)},module:function(a,c){g[a]||(g[a]=b),j(b).forEach(function(b){g[b]&&g[b].indexOf(a)!=-1&&i('Cross modular relation between modules "%s" and "%s". Modules not loaded.',a,b)}),k(function(b){l(a,c,b)},b)}}},p=function(a){for(var b=document.getElementsByTagName("script"),c=0;c<b.length;c++){var d=b[c].getAttribute("src")||"";if(d.indexOf(a)!=-1)return d.substr(0,d.indexOf(a))}return""},q=function(a){for(var b in d)if(0==a.indexOf(b))return d[b];return function(){for(var b=a.length+1;--b>0;){var d=a.substring(0,b);if("undefined"!=typeof c[d])return c[d]+"/"+a.substr(d.length).split(".").join("/")+".js"}return p("/modules.")+"/plugins/"+a.split(".").join("/")+".js"}().replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}).replace(/\/-/g,"/")},r=function(){return function(a){if(!f[a]||h.forced_loading){var b=document.createElement("script");b.setAttribute("src",a+(h.forced_loading?"?"+Math.random():"")),b.setAttribute("type","text/javascript"),document.getElementsByTagName("head")[0].appendChild(b),f[a]=!0}else m()}}(),s=function(a){var c=function(a){var b=a.match(/^(.*)\((.*)\)$/)||[];return 3==b.length?j(b[2].split("|")).map(function(a){return b[1]+a}):[a]},d=[];return j(a).forEach(function(a){j(c(a)).forEach(function(a){d.push(a),b[a]||setTimeout(function(){b[a]||r(q(a))},50)})}),d};c["modules."]=p("/modules.")+"/plugins";var t=function(a,b){for(var c in b)a[c]=b[c];return a};return{load:function(){return o(s(Array.prototype.slice.call(arguments)))},addPath:function(a,b){c[a]=b},addPackage:function(a,b){d[a]=b},publicateAPI:function(b,c){return"undefined"==typeof window[a][b]&&(window[a][b]=c),c},self:function(a){f[a]=!0},module:function(a,b){l(a,b)},setup:function(a){return t(h,a),this},name:window[a].name,$debugger:{modules:b,paths:c,packages:d,hooks:e,dependencies:g}}}("Modules")),Modules.load("device","utils","random").module("api",function(a){window.PREGGIEAPI=Modules;var b=function(){};b.prototype.deviceInterface=function(){return this},b.prototype.getCurrentUserId=function(){return"123456789"},b.prototype.showToast=function(a){alert(a)},b.prototype.getAuthToken=function(a){a=JSON.parse(a),window[a.success]({token:"JWT some token..."})},b.prototype.upload=function(a,b){b=JSON.parse(b);var c=0,d=(Math.random()>=.5?101:100,setInterval(function(){window[b.progress]({progress:c+=10}),100==c&&(clearInterval(d),window[b.success]({name:"2015:12:23:0820a982-8837-4f26-b8e0-cea32c121c6c.jpg"}))},500));return window[b.preview]("iVBORw0KGgoAAAANSUhEUgAAADEAAAA0CAIAAACsM0f4AAADPklEQVR42u2X30tTYRjHj+gMttqPznYwu9CbKUxCyh9sI6YLERkuJdRQKoKg/gDvu+jeP6Cgq0ohJLULiVkXDpRASwbbErdgY8yBUslsQzfDHjzx8uz17OxsHLcZ52EX73nPe57z2fN+n+d9Ts3x8TFTZVajMClMCpPCpDCdb6ZU6ncsFhFZYTSaWJYTvJXNZnZ3E3t7P/hLvZ41ma6oVPX5XMF6shhMo7moVl8SYNrc9E9NPRVhcrvH3O671GQ6vR8IbESjIWq+p8cFWPlcra158SMWy3WL5YY8TNvb0aWl9xqN+vRiESb4G4uLb/GMbEzJ5M+5uTeCQOJMVJCKYDIYTFqtDq9wOgfsdie5nJ9/fXR0SC61WkNLyzVQBoxBmhzXICgRUNLCwitqUirT5OSz1ta2fDGDXVtd/UguOzsdzc1mRoIFg1+DwY0zYfJ6P+zsxMU9CgZpevo5v92pVJrsuzxMs7Mv+QG4nph4IpL2+YJkNreFQgHZmKAULS8v8mOOu+pwDBQbJHhKp9PLyQS+fL7P2B3IKxz+dnCQNhiMICzBjItEQuvrXn5st/f5/V+SyV/FMdlsvUZjTtWGpOPrON4C8B6PR6nchn1pb7dSL5iZeaFS1Z4E7M/4+GOP513RTKeNRA4LHMsi9w/0NTY2CQaJT1KZmbC7fFZXd2F4+F6+IFFO5GcCwdpst7LZQ49nAVdRl2uML5u4mMGeQmhLZBLRE8Uk+G68fWQ9LhylMInkHXYHR0p//x1yi9Qt8iZcOPC7K8mEEwJEplb/q92JRJzUcRAZyxphgF0Vx4QP9oJMUhKC2MjIoxKZcH2i8qtiTFgiYEND93nZUs0a30KViYnqgUh6w4GD6ydhFTR56hPuM6leEZgymQyeaWoyd3U5RLzJz3S6p8YGdWh09KFgn3mGTEzuEUYZddiVj4k5EfvKyieqK7dae7Xay0whk8RU8ncw7CN8FDAnn5oSG06JVpXf5grT/8EUi30Ph3M62o6Om1Ky6QyZtrZ88MO3bbZ+lm2oPFNtbX13dy8/A0GSN89LZNJo9E7n7TJznEMmOEo5rpGfqQhcAY0PDj6oCias8fInHXNu9KQwCdhfKV/ntwyR1acAAAAASUVORK5CYII="),d},b.prototype.cancelUpload=function(a){clearInterval(a)},b.prototype.makePayment=function(b,c){c=JSON.parse(c),setTimeout(function(){window[c.success]({transaction_id:a.random.randomNumber()})},1e3)},b.prototype.getAppId=function(){return"123456789"},b.prototype.canExit=function(a){},b.prototype.isDevice=function(){return!(!window.Android&&!window.iOS)};var c=function(){this.deviceInterface=function(){return a.device.os.android()?window.Android:a.device.os.ios()?window.iOS:(new b).deviceInterface()},Object.defineProperties(this,{_token:{writable:!0,value:null},_canExit:{writable:!0,value:!0}})};return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.getCurrentUserId=function(){return this.deviceInterface().getCurrentUserId()},c.prototype.showToast=function(a){this.deviceInterface().showToast(a)},c.prototype.getAuthToken=function(b){function c(c){[f,g].forEach(function(b){a.utils.removeGlobalCallback(b)}),b.success&&b.success(e._token=c.token,c)}function d(c){[f,g].forEach(function(b){a.utils.removeGlobalCallback(b)}),b.error&&b.error(c)}if(!b)return this._token;var e=this,f=a.utils.createGlobalCallback(c),g=a.utils.createGlobalCallback(d);return this.deviceInterface().getAuthToken(JSON.stringify({success:f,error:g}))},c.prototype.upload=function(b,c){function d(b){[f,g,h,i].forEach(function(b){a.utils.removeGlobalCallback(b)}),c.success&&c.success(b)}function e(b){[f,g,h,i].forEach(function(b){a.utils.removeGlobalCallback(b)}),c.error&&c.error(b)}var f=a.utils.createGlobalCallback(c.preview),g=a.utils.createGlobalCallback(c.progress),h=a.utils.createGlobalCallback(d),i=a.utils.createGlobalCallback(e);return this.deviceInterface().upload(b,JSON.stringify({preview:f,progress:g,success:h,error:i}))},c.prototype.cancelUpload=function(a){this.deviceInterface().cancelUpload(a)},c.prototype.makePayment=function(b,c){function d(b){[f,g].forEach(function(b){a.utils.removeGlobalCallback(b)}),c.success&&c.success(b)}function e(b){[f,g].forEach(function(b){a.utils.removeGlobalCallback(b)}),c.error&&c.error(b)}var f=a.utils.createGlobalCallback(d),g=a.utils.createGlobalCallback(e);this.deviceInterface().makePayment(b,JSON.stringify({success:f,error:g}))},c.prototype.getAppId=function(){return this.deviceInterface().getAppId()},c.prototype.canExit=function(a){return arguments.length>0&&(this._canExit=!!a),this.deviceInterface().canExit(this._canExit),this._canExit},this.publicateAPI("API",new c)}),Modules.module("date",function(){var a={};return a.absolute=function(){var a=new Date(0);return{day:function(b){return a.setDate(b),this},month:function(b){return a.setMonth(b-1),this},year:function(b){return a.setFullYear(b),this},getTime:function(){return a.getTime()},getUTC:function(){return a.toUTCString()}}},a.unixtime=function(a){return~~((a||new Date).getTime()/1e3)},a.toLocaleString=function(b,c,d){var e=new Date(1e3*(b||a.unixtime()));return e.toLocaleString(c||"ru",d)},a.H_M=function(a){var b=new Date(1e3*a),c=b.getHours()<10?"0"+b.getHours():b.getHours(),d=b.getMinutes()<10?"0"+b.getMinutes():b.getMinutes();return c+":"+d},this.publicateAPI("date",a)}),Modules.module("device",function(){var a=navigator.userAgent,b=null,c=(a.match(/Web[kK]it[\/]{0,1}([\d.]+)/),a.match(/(Android);?[\s\/]+([\d.]+)?/)),d=a.match(/(iPad).*OS\s([\d_]+)/),e=a.match(/(iPod)(.*OS\s([\d_]+))?/),f=!d&&a.match(/(iPhone\sOS)\s([\d_]+)/),g={platform:{name:(navigator.platform.match(/mac|win|linux/i)||["unknown"])[0].toLowerCase()},webview:function(){return"undefined"!=typeof window.Android||"undefined"!=typeof window.iOS},os:{version:function(){return b},android:function(){return c&&(b=c[2]),c},ios:function(){return this.ipad()||this.ipod()||this.iphone()},ipad:function(){return d&&(b=d[2].replace(/_/g,".")),d},ipod:function(){return e&&(b=e[3]?e[3].replace(/_/g,"."):null),e},iphone:function(){return f&&!e&&(b=f[2].replace(/_/g,".")),f}}};return this.publicateAPI("device",g)}),Modules.module("random",function(){var a=function(a,b){for(var c=b||"ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz_0123456789",d=a||16,e=[],f=0,g=c.length-1;f<d;f++)e.push(c.charAt(Math.round(Math.random()*g)));return e.join("")},b=function(b){return"_"+a(b)},c=function(a){return parseInt(Math.random().toString().substr(2,a||10))},d={randomString:a,randomId:b,randomNumber:c};return this.publicateAPI("random",d)}),Modules.load("random").module("utils",function(a){var b=window,c={createGlobalCallback:function(c){for(var d=function(a){return b[a]=function(){c.call(b,arguments[0])},a},e=0;e++<10;){var f="_"+a.random.randomString();if("undefined"==typeof b[f])return d(f)}throw new Error("createGlobalCallback: cannot create unique name for callback")},removeGlobalCallback:function(a){try{b[a]=void 0,delete b[a]}catch(a){}},plural:function(a,b,c){var d=[2,0,1,1,1,2];return(c?a+" ":"")+b[a%100>4&&a%100<20?2:d[a%10<5?a%10:5]]}};return this.publicateAPI("utils",c)});