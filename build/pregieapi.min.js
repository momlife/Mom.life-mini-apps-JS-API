/*! PREGIE_JSAPI | 2015-11-12 */
window.PREGIEAPI||(window.PREGIEAPI=function(c){var d={},e={},f={},g=[],h={},m={forced_loading:!1},k=function(a){var b=a||[],d=function(a){for(var d=0;d<b.length;d++)a(b[d],d,b);return b};return{forEach:function(a){return d(function(){a.apply(b,arguments)})},map:function(a){var c=[];d(function(){c.push(a.apply(b,arguments))});return c},filter:function(a){var c=[];d(function(){a.apply(b,arguments)&&c.push(arguments[0])});return c}}},n=function(a,b){g.push([a,b]);l()},l=function(){var a=[];g=k(g).filter(function(b){return 0<
k(b[1]).filter(function(a){return!d[a]}).length||function(){a.push(function(a,b){return function(){a(b)}}(b[0],q(b[1])))}()});k(a).forEach(function(a){a()})},q=function(a){var b={};k(a).forEach(function(a){var c=b,e=a.split("."),f=e.pop();k(e).forEach(function(a){c=c[a]||(c[a]={})});c[f]=d[a]});return b},s=function(a){return{run:function(b){n(function(a){b.call(window[c],a)},a)},module:function(b,e){n(function(a){d[b]||(d[b]=e.call(window[c],a||void 0));l()},a);h[r(b)]=b}}},p=function(a){for(var b=
document.getElementsByTagName("script"),c=0;c<b.length;c++){var d=b[c].getAttribute("src")||"";if(-1!=d.indexOf(a))return d.substr(0,d.indexOf(a))}return""},r=function(a){for(var b in f)if(0==a.indexOf(b))return f[b];return function(){for(var b=a.length+1;0<--b;){var c=a.substring(0,b);if("undefined"!=typeof e[c])return e[c]+"/"+a.substr(c.length).split(".").join("/")+".js"}return p("/pregieapi.")+"/plugins/"+a.split(".").join("/")+".js"}().replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}).replace(/\/-/g,
"/")};(function(){return function(a){if(!h[a]||m.forced_loading){var b=document.createElement("script");b.setAttribute("src",a+(m.forced_loading?"?"+Math.random():""));b.setAttribute("type","text/javascript");document.getElementsByTagName("head")[0].appendChild(b);h[a]=!0}else l()}})();var t=function(a){var b=function(a){var b=a.match(/^(.*)\((.*)\)$/)||[];return 3==b.length?k(b[2].split("|")).map(function(a){return b[1]+a}):[a]},c=[];k(a).forEach(function(a){k(b(a)).forEach(function(a){c.push(a)})});
return c};e["pregieapi."]=p("/pregieapi.")+"/plugins";return{load:function(){return s(t(arguments))},addPath:function(a,b){e[a]=b},addPackage:function(a,b){f[a]=b},publicateAPI:function(a,b){"undefined"==typeof window[c][a]&&(window[c][a]=b);return b},self:function(a){h[a]=!0},module:function(a,b){d[a]||(d[a]=b.call(window[c],void 0));l()},setup:function(a){for(var b in a)m[b]=a[b];return this},$debugger:{modules:d,paths:e,packages:f,hooks:g}}}("PREGIEAPI"));
PREGIEAPI.load("device").module("api",function(c){var d=function(){};d.prototype.deviceInterface=function(){return this};d.prototype.getCurrentUserId=function(){throw Error("MOCK INTERFACE - getCurrentUserId()");};d.prototype.showToast=function(){throw Error("MOCK INTERFACE - showToast()");};d.prototype.getAuthToken=function(){return"test-token"};var e=function(){this.deviceInterface=function(){return c.device.os.android()?window.Android:c.device.os.ios()?window.iOS:(new d).deviceInterface()}};e.prototype=
Object.create(d.prototype);e.prototype.constructor=e;e.prototype.getCurrentUserId=function(){return this.deviceInterface().getCurrentUserId()};e.prototype.showToast=function(c){this.deviceInterface().showToast(c)};e.prototype.getAuthToken=function(){return this.deviceInterface().getAuthToken()};return this.publicateAPI("API",new e)});
PREGIEAPI.module("date",function(){return this.publicateAPI("date",{absolute:function(){var c=new Date(0);return{day:function(d){return c.setDate(d),this},month:function(d){return c.setMonth(d-1),this},year:function(d){return c.setFullYear(d),this},getTime:function(){return c.getTime()},getUTC:function(){return c.toUTCString()}}},unixtime:function(c){return~~((c||new Date).getTime()/1E3)}})});
PREGIEAPI.module("device",function(c){c=navigator.userAgent;var d=null;c.match(/Web[kK]it[\/]{0,1}([\d.]+)/);var e=c.match(/(Android);?[\s\/]+([\d.]+)?/),f=c.match(/(iPad).*OS\s([\d_]+)/),g=c.match(/(iPod)(.*OS\s([\d_]+))?/),h=!f&&c.match(/(iPhone\sOS)\s([\d_]+)/);c={platform:{name:(navigator.platform.match(/mac|win|linux/i)||["unknown"])[0].toLowerCase()},webview:function(){return"undefined"!=typeof window.Android||"undefined"!=typeof window.iOS},os:{version:function(){return d},android:function(){e&&
(d=e[2]);return e},ios:function(){return this.ipad()||this.ipod()||this.iphone()},ipad:function(){f&&(d=f[2].replace(/_/g,"."));return f},ipod:function(){g&&(d=g[3]?g[3].replace(/_/g,"."):null);return g},iphone:function(){h&&!g&&(d=h[2].replace(/_/g,"."));return h}}};return this.publicateAPI("device",c)});
