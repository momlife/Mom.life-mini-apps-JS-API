/*! PREGIE_JSAPI | 2015-11-18 */
window.PREGIEAPI||(window.PREGIEAPI=function(b){var c={},e={},f={},h=[],g={},l={forced_loading:!1},k=function(a){var d=a||[],b=function(a){for(var b=0;b<d.length;b++)a(d[b],b,d);return d};return{forEach:function(a){return b(function(){a.apply(d,arguments)})},map:function(a){var c=[];b(function(){c.push(a.apply(d,arguments))});return c},filter:function(a){var c=[];b(function(){a.apply(d,arguments)&&c.push(arguments[0])});return c}}},n=function(a,d){h.push([a,d]);m()},m=function(){var a=[];h=k(h).filter(function(d){return 0<
k(d[1]).filter(function(a){return!c[a]}).length||function(){a.push(function(a,d){return function(){a(d)}}(d[0],q(d[1])))}()});k(a).forEach(function(a){a()})},q=function(a){var d={};k(a).forEach(function(a){var b=d,f=a.split("."),e=f.pop();k(f).forEach(function(a){b=b[a]||(b[a]={})});b[e]=c[a]});return d},s=function(a){return{run:function(d){n(function(a){d.call(window[b],a)},a)},module:function(d,f){n(function(a){c[d]||(c[d]=f.call(window[b],a||void 0));m()},a);g[r(d)]=d}}},p=function(a){for(var d=
document.getElementsByTagName("script"),b=0;b<d.length;b++){var c=d[b].getAttribute("src")||"";if(-1!=c.indexOf(a))return c.substr(0,c.indexOf(a))}return""},r=function(a){for(var d in f)if(0==a.indexOf(d))return f[d];return function(){for(var d=a.length+1;0<--d;){var b=a.substring(0,d);if("undefined"!=typeof e[b])return e[b]+"/"+a.substr(b.length).split(".").join("/")+".js"}return p("/pregieapi.")+"/plugins/"+a.split(".").join("/")+".js"}().replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()}).replace(/\/-/g,
"/")};(function(){return function(a){if(!g[a]||l.forced_loading){var d=document.createElement("script");d.setAttribute("src",a+(l.forced_loading?"?"+Math.random():""));d.setAttribute("type","text/javascript");document.getElementsByTagName("head")[0].appendChild(d);g[a]=!0}else m()}})();var t=function(a){var d=function(a){var b=a.match(/^(.*)\((.*)\)$/)||[];return 3==b.length?k(b[2].split("|")).map(function(a){return b[1]+a}):[a]},b=[];k(a).forEach(function(a){k(d(a)).forEach(function(a){b.push(a)})});
return b};e["pregieapi."]=p("/pregieapi.")+"/plugins";return{load:function(){return s(t(arguments))},addPath:function(a,b){e[a]=b},addPackage:function(a,b){f[a]=b},publicateAPI:function(a,d){"undefined"==typeof window[b][a]&&(window[b][a]=d);return d},self:function(a){g[a]=!0},module:function(a,d){c[a]||(c[a]=d.call(window[b],void 0));m()},setup:function(a){for(var b in a)l[b]=a[b];return this},$debugger:{modules:c,paths:e,packages:f,hooks:h}}}("PREGIEAPI"));
PREGIEAPI.load("device","utils").module("api",function(b){var c=function(){};c.prototype.deviceInterface=function(){return this};c.prototype.getCurrentUserId=function(){throw Error("MOCK INTERFACE - getCurrentUserId()");};c.prototype.showToast=function(){throw Error("MOCK INTERFACE - showToast()");};c.prototype.getAuthToken=function(){return"test-token"};c.prototype.uploadImage=function(b){b=JSON.parse(b);var c=0,e=setInterval(function(){window[b.progress]({status:200,progress:++c});10==c&&(clearInterval(e),
window[b.done]({status:200,url:"https://www.google.ru/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png"}))},1E3)};var e=function(){this.deviceInterface=function(){return b.device.os.android()?window.Android:b.device.os.ios()?window.iOS:(new c).deviceInterface()}};e.prototype=Object.create(c.prototype);e.prototype.constructor=e;e.prototype.getCurrentUserId=function(){return this.deviceInterface().getCurrentUserId()};e.prototype.showToast=function(b){this.deviceInterface().showToast(b)};
e.prototype.getAuthToken=function(){return this.deviceInterface().getAuthToken()};e.prototype.uploadImage=function(c){var e=b.utils.createGlobalCallback(c.progress),g=b.utils.createGlobalCallback(function(l){[e,g].forEach(function(c){b.utils.removeGlobalCallback(c)});c.done&&c.done(l)});this.deviceInterface().uploadImage(JSON.stringify({progress:e,done:g}))};return this.publicateAPI("API",new e)});
PREGIEAPI.module("date",function(){return this.publicateAPI("date",{absolute:function(){var b=new Date(0);return{day:function(c){return b.setDate(c),this},month:function(c){return b.setMonth(c-1),this},year:function(c){return b.setFullYear(c),this},getTime:function(){return b.getTime()},getUTC:function(){return b.toUTCString()}}},unixtime:function(b){return~~((b||new Date).getTime()/1E3)}})});
PREGIEAPI.module("device",function(b){b=navigator.userAgent;var c=null;b.match(/Web[kK]it[\/]{0,1}([\d.]+)/);var e=b.match(/(Android);?[\s\/]+([\d.]+)?/),f=b.match(/(iPad).*OS\s([\d_]+)/),h=b.match(/(iPod)(.*OS\s([\d_]+))?/),g=!f&&b.match(/(iPhone\sOS)\s([\d_]+)/);b={platform:{name:(navigator.platform.match(/mac|win|linux/i)||["unknown"])[0].toLowerCase()},webview:function(){return"undefined"!=typeof window.Android||"undefined"!=typeof window.iOS},os:{version:function(){return c},android:function(){e&&
(c=e[2]);return e},ios:function(){return this.ipad()||this.ipod()||this.iphone()},ipad:function(){f&&(c=f[2].replace(/_/g,"."));return f},ipod:function(){h&&(c=h[3]?h[3].replace(/_/g,"."):null);return h},iphone:function(){g&&!h&&(c=g[2].replace(/_/g,"."));return g}}};return this.publicateAPI("device",b)});
